<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Plan üåª</title>
    <style>
        /* === WARM VINTAGE SUNFLOWER THEME === */
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background-color: #fff8e1; /* Creamy Off-White Background */
            color: #4e342e; /* Deep Brown Text (Softer than black) */
            padding: 0; margin: 0; padding-bottom: 80px; 
        }
        
        /* Nav & Edit Buttons */
        .menu-btn { 
            position: fixed; top: 15px; left: 15px; font-size: 20px; cursor: pointer; 
            color: #f57f17; background: #fffdf0; padding: 8px 10px; border-radius: 8px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 1000; border: 1px solid #ffe082;
        }
        
        .edit-btn { 
            position: fixed; top: 15px; right: 15px; font-size: 14px; cursor: pointer; color: white; 
            background: #fbc02d; padding: 8px 15px; border-radius: 20px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 1000; font-weight: bold; border: 2px solid #fff; transition: 0.3s; 
        }
        .edit-btn.editing { background: #43a047; } 

        /* Sidebar CSS (Warm Style) */
        .side-menu { height: 100%; width: 0; position: fixed; z-index: 2000; top: 0; left: 0; background-color: #fffdf0; overflow-x: hidden; transition: 0.3s; box-shadow: 2px 0 10px rgba(0,0,0,0.1); padding-top: 60px; }
        .side-menu a { padding: 15px 25px; text-decoration: none; font-size: 18px; color: #f57f17; display: block; font-weight: bold; border-bottom: 1px solid #ffe082; }
        .side-menu .close-btn { position: absolute; top: 10px; right: 20px; font-size: 30px; cursor: pointer; color: #f57f17; }
        
        /* Header */
        .header { text-align: center; margin-top: 70px; margin-bottom: 20px; }
        h2 { color: #f9a825; font-family: 'Courier New', monospace; margin: 0; text-shadow: 1px 1px #fff; }
        p { font-size: 13px; color: #8d6e63; font-weight: bold; }

        /* === STUDY PLAN CARDS (Off-White) === */
        .container { padding: 15px; display: flex; flex-direction: column; gap: 20px; }
        
        .day-card { 
            background: #fffdf0; /* Ivory / Off-White Card */
            padding: 20px; border-radius: 20px; 
            box-shadow: 0 5px 15px rgba(141, 110, 99, 0.1); 
            border: 1px solid #ffe082; position: relative; 
            border-left: 6px solid #fbc02d; /* Sunflower Left Border */
        }

        /* Day Title Input */
        .day-title-input {
            font-size: 20px; font-weight: bold; color: #f57f17; border: none; 
            border-bottom: 2px dashed #ffecb3; width: 100%; padding-bottom: 5px; margin-bottom: 15px;
            background: transparent; outline: none;
        }

        /* Task Row (Slightly darker off-white for contrast) */
        .task-row {
            display: flex; flex-direction: column; gap: 5px; 
            background: #fff8e1; /* Matching body bg */
            padding: 10px; border-radius: 10px; margin-bottom: 10px;
            border: 1px solid #fff9c4; position: relative;
        }

        .subject-input {
            font-weight: bold; color: #5d4037; border: none; background: transparent; font-size: 16px; width: 90%;
        }
        .syllabus-input {
            font-size: 13px; color: #8d6e63; border: none; background: transparent; width: 90%;
        }
        
        /* Checkbox & Delete */
        .row-header { display: flex; justify-content: space-between; align-items: center; }
        .task-check { accent-color: #fbc02d; transform: scale(1.3); cursor: pointer; }
        
        .delete-task-btn {
            position: absolute; top: 5px; right: 5px; color: #d84315; background: none; border: none; cursor: pointer; display: none;
        }

        /* Add Buttons */
        .add-task-btn {
            display: none; width: 100%; padding: 8px; background: #fff3e0; 
            border: 1px dashed #ffb74d; color: #e65100; border-radius: 10px; 
            cursor: pointer; margin-top: 5px; font-size: 12px; font-weight: bold;
        }
        
        .add-day-btn { 
            display: none; width: 100%; padding: 15px; background: #fffdf0; 
            border: 2px dashed #fbc02d; color: #fbc02d; font-weight: bold; 
            border-radius: 20px; cursor: pointer; font-size: 16px;
        }

        .delete-day-btn {
            position: absolute; top: 15px; right: 15px; background: #ffccbc; color: #d84315; 
            border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; display: none;
        }

        /* Footer */
        .footer-btns { text-align: center; margin-top: 20px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
        .save-btn { padding: 12px 40px; background: linear-gradient(45deg, #fbc02d, #f57f17); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 10px rgba(251, 192, 45, 0.3); }
        .reset-btn { padding: 10px 30px; background: #d7ccc8; color: #5d4037; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; }

        /* Modal (Warm) */
        #romanticModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 248, 225, 0.9); backdrop-filter: blur(5px); z-index: 3000; justify-content: center; align-items: center; }
        .modal-box { background: #fffdf0; padding: 25px; border-radius: 20px; text-align: center; box-shadow: 0 10px 25px rgba(249, 168, 37, 0.2); border: 2px solid #ffe082; width: 80%; max-width: 300px; }
        .modal-input { width: 80%; padding: 10px; border: 2px solid #ffe082; border-radius: 50px; text-align: center; margin-bottom: 15px; font-size: 16px; outline: none; background: #fff8e1; color: #5d4037; }
        .modal-btn { padding: 8px 25px; background: #fbc02d; color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; }
        .close-modal { position: absolute; top: 20px; right: 20px; cursor: pointer; color: #f57f17; }

    </style>
</head>
<body>

    <div class="menu-btn" onclick="openNav()">‚ò∞</div>
    <button id="editBtn" class="edit-btn" onclick="triggerEdit()">‚úé Edit</button>

    <div id="sidebar-placeholder"></div>

    <div id="romanticModal">
        <div class="close-modal" onclick="closeModal()">&times;</div>
        <div class="modal-box">
            <h3 style="color:#f9a825;">Enter the digit üåª</h3>
            <input type="number" id="secretPass" class="modal-input" placeholder="****">
            <br>
            <button class="modal-btn" onclick="verifyPass()">Unlock üíõ</button>
            <p id="errMsg" style="display:none; color:#d84315; font-size:12px; margin-top:10px;">Wrong code sunshine! ü•∫</p>
        </div>
    </div>

    <div class="header">
        <h2>üåª Study Plan üåª</h2>
        <p>One step at a time, my love! ‚ú®</p>
    </div>

    <div class="container" id="planContainer">
        </div>

    <div class="container">
        <button class="add-day-btn" id="addDayBtn" onclick="addDay()">+ Add New Day üìÖ</button>
    </div>

    <div class="footer-btns">
        <button class="save-btn" onclick="saveData()">Save Plan üíõ</button>
        <button class="reset-btn" onclick="resetData()">Reset All üîÑ</button>
    </div>

    <script src="sidebar.js"></script>

    <script>
        // --- DATA STRUCTURE ---
        const defaultPlan = [
            {
                id: Date.now(),
                title: "Day 1: Kickoff üöÄ",
                tasks: [
                    { subject: "Physics", syllabus: "Chapter 1 & 2 Revision", done: false },
                    { subject: "Chemistry", syllabus: "Organic Basics", done: false }
                ]
            }
        ];

        let studyPlan = [];
        let isEditing = false;

        window.onload = function() { loadData(); renderPlan(); };

        // --- RENDER LOGIC ---
        function renderPlan() {
            const container = document.getElementById("planContainer");
            container.innerHTML = "";

            studyPlan.forEach((day, dayIndex) => {
                const dayCard = document.createElement("div");
                dayCard.className = "day-card";

                let tasksHtml = "";
                
                day.tasks.forEach((task, taskIndex) => {
                    tasksHtml += `
                        <div class="task-row">
                            <div class="row-header">
                                <input type="text" class="subject-input" value="${task.subject}" 
                                    placeholder="Subject"
                                    onchange="updateTask(${dayIndex}, ${taskIndex}, 'subject', this.value)" 
                                    ${isEditing ? "" : "readonly"}>
                                <input type="checkbox" class="task-check" 
                                    onchange="toggleTask(${dayIndex}, ${taskIndex})" 
                                    ${task.done ? "checked" : ""}>
                            </div>
                            <input type="text" class="syllabus-input" value="${task.syllabus}" 
                                placeholder="Syllabus details..."
                                onchange="updateTask(${dayIndex}, ${taskIndex}, 'syllabus', this.value)" 
                                ${isEditing ? "" : "readonly"}>
                            
                            <button class="delete-task-btn" onclick="deleteTask(${dayIndex}, ${taskIndex})" 
                                style="display: ${isEditing ? 'block' : 'none'}">‚úñ</button>
                        </div>
                    `;
                });

                dayCard.innerHTML = `
                    <input type="text" class="day-title-input" value="${day.title}" 
                        onchange="updateDayTitle(${dayIndex}, this.value)" 
                        ${isEditing ? "" : "readonly"}>
                    
                    <button class="delete-day-btn" onclick="deleteDay(${dayIndex})" 
                        style="display: ${isEditing ? 'block' : 'none'}">üóëÔ∏è</button>

                    <div class="tasks-container">
                        ${tasksHtml}
                    </div>

                    <button class="add-task-btn" onclick="addTask(${dayIndex})" 
                        style="display: ${isEditing ? 'block' : 'none'}">+ Add Subject</button>
                `;

                container.appendChild(dayCard);
            });

            document.getElementById("addDayBtn").style.display = isEditing ? "block" : "none";
        }

        // --- DATA FUNCTIONS ---
        function addDay() {
            studyPlan.push({
                id: Date.now(),
                title: `Day ${studyPlan.length + 1} üåª`,
                tasks: [{ subject: "New Subject", syllabus: "Topics...", done: false }]
            });
            renderPlan();
        }

        function deleteDay(index) {
            if(confirm("Remove this entire day? üóëÔ∏è")) {
                studyPlan.splice(index, 1);
                renderPlan();
            }
        }

        function updateDayTitle(index, val) { studyPlan[index].title = val; }
        function addTask(dayIndex) { studyPlan[dayIndex].tasks.push({ subject: "", syllabus: "", done: false }); renderPlan(); }
        function deleteTask(dayIndex, taskIndex) { studyPlan[dayIndex].tasks.splice(taskIndex, 1); renderPlan(); }
        function updateTask(dayIndex, taskIndex, field, val) { studyPlan[dayIndex].tasks[taskIndex][field] = val; }
        function toggleTask(dayIndex, taskIndex) { studyPlan[dayIndex].tasks[taskIndex].done = !studyPlan[dayIndex].tasks[taskIndex].done; saveData(); }

        // --- EDIT MODE (PASSWORD: 0812) ---
        function triggerEdit() {
            if(isEditing) {
                isEditing = false;
                document.getElementById("editBtn").classList.remove("editing");
                document.getElementById("editBtn").innerText = "‚úé Edit";
                saveData();
                renderPlan();
            } else {
                document.getElementById("romanticModal").style.display = "flex";
                document.getElementById("secretPass").value = "";
                document.getElementById("errMsg").style.display = "none";
            }
        }

        function verifyPass() {
            if(document.getElementById("secretPass").value === "0812") {
                isEditing = true;
                document.getElementById("romanticModal").style.display = "none";
                document.getElementById("editBtn").classList.add("editing");
                document.getElementById("editBtn").innerText = "‚úì Done";
                renderPlan();
            } else {
                document.getElementById("errMsg").style.display = "block";
            }
        }
        function closeModal() { document.getElementById("romanticModal").style.display = "none"; }

        // --- STORAGE & NAV ---
        function saveData() {
            localStorage.setItem("myStudyPlanData", JSON.stringify(studyPlan));
            alert("Plan Saved Successfully! üåª");
            syncToCloud();
        }

        function loadData() {
            const saved = localStorage.getItem("myStudyPlanData");
            if(saved) studyPlan = JSON.parse(saved);
            else studyPlan = JSON.parse(JSON.stringify(defaultPlan));
        }

        function resetData() {
            if(confirm("Reset entire study plan? üòÆ")) {
                localStorage.removeItem("myStudyPlanData");
                location.reload();
            }
        }

        function openNav() { document.getElementById("mySidenav").style.width = "250px"; }
        function closeNav() { document.getElementById("mySidenav").style.width = "0"; }
    </script>

    <script>
        const REMOTE_BIN_ID = "697a8010d0ea881f408e87d7"; 
        const REMOTE_API_KEY = "$2a$10$vhszPYO/HWMSbnMiDUcq7eIW6i8BecKgdG6QteMm/FPJ/22fP/VBS";

        async function syncToCloud() {
            try {
                let response = await fetch(`https://api.jsonbin.io/v3/b/${REMOTE_BIN_ID}/latest`, { headers: { 'X-Master-Key': REMOTE_API_KEY } });
                let result = await response.json();
                let currentData = result.record;
                currentData.study_plan = studyPlan; 
                await fetch(`https://api.jsonbin.io/v3/b/${REMOTE_BIN_ID}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'X-Master-Key': REMOTE_API_KEY },
                    body: JSON.stringify(currentData)
                });
                console.log("Plan synced to cloud! ‚òÅÔ∏è");
            } catch (error) { console.log("Offline"); }
        }
    </script>
</body>
</html>
